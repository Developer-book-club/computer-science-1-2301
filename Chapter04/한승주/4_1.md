# 4.1 데이터베이스의 기본


### 데이터베이스

<aside>
💡 데이터베이스 : 일정한 규칙, 또는 규약을 통해 구조화되어 저장되는 데이터의 모음

</aside>

> **DBMS** : 데이터베이스를 제어, 관리하는 통합 시스템
> 
- 특정 DBMS 마다 정의되 쿼리언어(query language) 를 통해 삽입, 삭제, 수정, 조회 등을 수행
- 실시간 접근과 동시 공유 가능

## 4.1.1 엔터티

<aside>
💡 사람, 장소, 물건, 사건 ,개념 등 여러 개의 속성을 지닌 명사

</aside>

- 서비스의 요구 사항에 맞춰 속성이 정해짐

### 약한 엔터티와 강한 엔터티

- 약한 엔터티 : 혼자서는 존재하지 못하고 다른 엔터티(B)의 존재여부에 따라 종속적

## 4.1.2 릴레이션

<aside>
💡 데이터베이스에서 정보를 구분하여 저장하는 기본 단위

</aside>

- 엔터티에 관한 데이터 → 릴레이션 하나에 담아서 관리
    - 관계형 데이터베이스 : **테이블**
    - NoSQL 데이터베이스 : **컬렉션**

### 테이블과 컬렉션

- 관계형 데이터베이스 (MySQL 등)
    - 레코드-테이블-데이터베이스 구조
- NoSQL 데이터베이스(MongoDB 등)
    - 도큐먼트-컬렉션-데이터베이스 구조
    

## 4.1.3 속성

<aside>
💡 릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보

</aside>

- EX) 차 (엔터티) 의 속성
    - 차 번호
    - 바퀴수
    - 차 색깔
    - 차종
- 서비스의 요구사항을 기반으로 관리해야 할 필요가 있는 속성들만 엔터티의 속성이 될 수 있다.

## 4.1.4 도메인

<aside>
💡 릴레이션에 포함된 각각의 속성들이 가질 수 있는 값의 집합

</aside>

- EX) 성별 의 도메인 : ‘남’ , ‘여’ 중 하나

## 4.1.5 필드와 레코드

- 데이터베이스의 필드와 레코드로 구성된 테이블 예시
- member

| name | ID | address | phonenumber |
| --- | --- | --- | --- |
| 큰돌 | kundol | 서울 | 112 |
| 가영 | kay | 대전 | 114 |
| 빅뱅 | big | 카이로 | 119 |
- 엔터티 : 회원(member) 테이블
- 속성 : 이름, 아이디, 주소 ,휴대폰번호
    - **필드** : name, ID, address, phonenumber
- **레코드(튜플)** : 테이블에 쌓이는 행 단위의 데이터

### 필드 타입

- 문자열, 숫자 등의 타입을 갖는다.
- DBMS 마다 타입이 다르다. (책에서는 MySQL 기준으로 설명)
- **숫자 타입**
    - `TINYINT`, `SMALLINT`, `MEDIUMINT`, `INT`, `BIGINT`
    
    | 타입 | 용량 | 최솟값(부호있음) | 최솟값(부호없음) | 최댓값(부호없음) | 최댓값(부호있음) |
    | --- | --- | --- | --- | --- | --- |
    | TINYINT | 1` | -128 | 0 | 127 | 255 |
    | SMALLINT | 2 | -32768 | 0 | 32767 | 65535 |
    | MEDIUMINT | 3 | -8388608 | 0 | 8388607 | 16777215 |
    | INT | 4 | -2147483648 | 0 | 2147483647 | 4294967295 |
    | BIGINT | 5 | -263 | 0 | 263-1 | 264-1 |
- 날짜 타입
    - `DATE`, `DATETIME`, `TIMESTAMP`
    - **DATE** : 날짜 부분은 있지만 시간 부분은 없는 값
    - **DATETIME** : 날짜 및 시간 부분을 모두 포함하는 값
    - **TIMESTAMP** : 날짜 및 시간 부분을 모두 포함하는 값 (사용할 수 있는 날짜 범위가 좁고, 용량이 작음)
    
- 문자 타입
    - `CHAR`, `VARCHAR`, `TEXT`, `BLOB`, `ENUM`, `SET`
    
    - **CHAR** : 테이블을 생성할 때 선언을 해서 길이를 고정, 0~255 사이의 길이를 가짐
        - CHAR(30) - 최대 30글자까지 입력
        - 레코드를 선언한 길이 값으로 무조건 고정해서 사용
        
    - **VARCHAR** : 가변길이 문자열 / 길이를 0~65535 사이의 값으로 지정
        - 입력한 데이터에 따라 용량을 가변시켜 저장
    
    - **TEXT** : 큰 문자열 저장에 쓰며 게시판의 본문을 저장할 때 사용
    
    - **BLOB** : 이미지, 동영상 등 큰 데이터 저장에 사용
        - 이미지는 이미지 호스팅 서버에 올리고 파일의 경로를 VARCHAR로 저장하는 방법을 더 많이 쓴다.

## 4.1.6 관계

<aside>
💡 여러 개의 데이터베이스 테이블 사이에 서로의 관계가 정의됨

</aside>

### 1:1관계

서로 1대1로 매칭되는 경우

- EX) 유저 당 유저 이메일

### 1:N 관계

한 테이블 당 다른 테이블의 여러 개의 필드가 연결되는 경우

- EX) 쇼핑몰에서 한 유저가 여러가지 상품을 장바구니에 넣는 경우
    - 유저 테이블 (이름,전화번호,주소)
    - 상품 테이블(상품이름, 가격, 출시일 등)
    

### N:M 관계

A테이블과 B테이블 모두 서로의 필드를 여러개 포함하는 경우

- EX) 대학교에서 학생과 강의의 관계
    - 학생도 강의를 많이 들을 수 있고, 강의도 여러명의 학생을 포함할 수 있음
    - 이런 경우 1:N , 1:M 관계를 갖는 테이블 2개로 나누어 설정
    - 테이블 2개를 직접적으로 연결하지 않음
    

## 4.1.7 키

<aside>
💡 테이블 간의 관계를 조금 더 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치

</aside>

- 기본키, 외래키, 후보키, 슈퍼키, 대체키 등

### 기본키

<aside>
💡 유일성과 최소성을 만족하는 키

</aside>

- 필드 내 값들이 중복될 수 없다.
- 자연키와 인조키 중 골라서 설정
    - 자연키 : 이름, 주민등록, 성별 등등 이미 존재하는 값들 중에 중복된 값들(성별, 이름 등)을 제외하고 자연스럽게 뽑힌 키
        - 언젠가는 변할 수 있다.
    - 인조키 : 인위적으로 부여하는 유저아이디
        - 변하지 않으므로 기본키는 대부분 인조키로 설정됨
        

### 외래키

<aside>
💡 다른 테이블의 기본키를 그대로 참조하는 값 / 개체와의 관계를 식별하기 위해 사용

</aside>

- 외래키는 중복될 수 있다.

- client 테이블

| ID | name | contact |
| --- | --- | --- |
| a_1 | 주홍철 | 112 |
| a_2 | 연제호 | 114 |
- product 테이블

| ID | user_id | name |
| --- | --- | --- |
| PDT-0001 | a_2 | 아우디 |
| PDT-0002 | a_2 | 벤츠 |
| PDT-0003 | a_2 | BMW |

client의 ID 필드가 product 테이블의 외래키로 그대로 참조되고 있다. 

### 후보키

<aside>
💡 기본키가 될 수 있는 후보들이며 유일성과 최소성을 동시에 만족하는 키

</aside>

### 대체키

<aside>
💡 후보키가 두 개 이상일 경우 어느 하나를 기본키로 지정하고 남은 후보키

</aside>

### 슈퍼키

<aside>
💡 각 레코들을 유일하게 식별할 수 있는 유일성을 갖춘 키

</aside>