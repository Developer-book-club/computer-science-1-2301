# 4.2 ERD와 정규화 과정


## 4.2.1 ERD의 중요성

<aside>
💡 ERD(entity Relationship Diagram) : 데이터베이스를 구축할 때 가장 기초적인 뼈대 역할을 하며, 릴레이션 간의 관계들을 정의한 것

</aside>

- 시스템의 요구사항을 기반으로 작성되며 ERD를 기반으로 데이터베이스를 구축
- 데이터베이스를 구축한 이후에도 디버깅 또는 비즈니스 프로세스 재설계가 필요한 경우에 설계도 역할을 담당
- **관계형 구조로 표현할 수 있는 데이터**를 구성하는데 유용하나, **비정형 데이터**는 충분히 표현하기 어려움
    
    > 비정형 데이터 : 비구조화 데이터를 말하며, 미리 정의된 데이터 모델이 없거나 미리 정의된 방식으로 정리되지 않은 정보
    > 

## 4.2.2 예제로 배우는 ERD

### (예제) 승원 영업부서의 ERD

- 요구사항
    1. 영업사원은 0~n 명의 고객을 관리한다.
    2. 고객은 0~n 개의 주문을 넣을 수 있다.
    3. 주문에는 1~n개의 상품이 들어간다. 
    
    ![Untitled](4%202%20ERD%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%80%E1%85%B2%E1%84%92%E1%85%AA%20%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A5%E1%86%BC%20d7029f58279d459989659792cfcf586b/Untitled.png)
    

### (예제2) 무무오브레전드의 ERD

- 요구사항
    1. 선수들은 1명의 챔피언을 고를 수 있다.
    2. 챔피언은 한 개 이상의 스킬을 갖는다
    3. 스킬은 한 개 이상의 특성을 갖는다
    
    ![Untitled](4%202%20ERD%E1%84%8B%E1%85%AA%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%80%E1%85%B2%E1%84%92%E1%85%AA%20%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A5%E1%86%BC%20d7029f58279d459989659792cfcf586b/Untitled%201.png)
    

## 4.2.3 정규화 과정

<aside>
💡 릴레이션 간의 잘못된 종속 관계로 인해 데이터베이스 이상 현상이 일어나 이를 해결하거나, 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정

</aside>

> 데이터베이스 이상 현상 : 회원이 한 개의 등급을 가져야 하는데 여러 개의 등급을 동시에 가지거나 / 삭제될 때 필요한 데이터가 같이 삭제되고 / 데이터를 삽입해야 하는데 하나의 필드값이 NULL 이 되면 안 되어서 삽입하기 어려운 현상 등
> 

### 정규형 원칙

- 같은 의미를 표현하는 릴레이션이지만 좀 더 좋은 구조로 만들기
- 자료의 중복성 감소
- 독립적인 관계는 별개의 릴레이션으로 표현
- 각각의 릴레이션은 독립적인 표현이 가능해야 함

### 제1정규형

- 릴레이션의 모든 도메인이 더 이상 분해될 수 없는 원자 값(atomic value) 으로만 구성
- 릴레이션의 속성 값 중에서 반복 집합이 있으서는 안된다.
    - 반복집합 : 한 개의 기본키에 대해 두 개 이상의값을 가짐
    - 반복집합을 제거해야 한다.

### 제2정규형

**(?이거 왜함)** 

- 릴레이션이 제1정규형이며 부분 함수의 종속성을 제거한 형태
    - 부분 함수의 종속성 제거 : 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속적인 것
    - 릴레이션을 분해할 때 동등한 릴레이션으로 분해해야함
    - 정보 손실이 발생하지 않는 무손실 분해로 분해해야 함

### 제3정규형

- 제2정규형이고 기본키가 아닌 모든 속성이 이행적 함수 종속(transitive FD) 를 만족하지 않는 상태
- 이행적 함수 종속 ?
    
    > A→B, B→C ⇒ A→C 성립
    > 
    - 이 때 집합 C는 집합 A에 이행적으로 함수 종속됨
- (예제설명) 등급이  플래티넘이면 할인율이 30%인 것은 당연하므로 분리함 ?

### 보이스/코드 정규형

- 제3정규형 중 하나로, 결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 상태
    
    > 결정자 : 함수 종속 관계에서 특정 종속자를 결정짓는 요소 | X→Y 일 때 X는 결정자, Y는 종속자이다.
    > 

> 정규형 과정을 거쳐 테이블을 나눈다고 해서 성능이 100% 좋아지는 것은 아니므로, 서비스에 따라 정규화 / 비정규화 과정을 진행해야 한다.
>